{% extends 'base.html' %}
{% load static %}

{% block title %}{{ job.title }} - JobML Platform{% endblock %}

{% block content %}
<!-- Page Header Start -->
<div class="page-header">
  <div class="container">
    <div class="row">         
      <div class="col-lg-8 col-md-6 col-xs-12">
        <div class="breadcrumb-wrapper">
          <div class="content">
            <h3 class="product-title">{{ job.title }}</h3>
            <p class="brand">{{ job.company_name }}</p>
            <div class="tags">  
              <span><i class="lni-map-marker"></i> {{ job.location }}</span>  
              <span><i class="lni-calendar"></i> Posted {{ job.created_at|date:"d M, Y" }}</span>
              {% if not job.approved %}
              <span class="badge badge-warning">
                Pending Approval
              </span>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-4 col-md-6 col-xs-12">
        <div class="month-price">
          <span class="year">{{ job.job_type }}</span>
          <div class="price">
            {% if job.salary_range %}
            {{ job.salary_range }}
            {% else %}
            Salary Not Disclosed
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Page Header End --> 

<!-- Job Detail Section Start -->  
<section class="job-detail section">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-12 col-xs-12">
        <div class="job-description" style="background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 20px;">
          <h3 class="desc-title" style="color: #333; border-bottom: 3px solid #4c6ef5; padding-bottom: 10px; margin-bottom: 20px; font-weight: 600;">üìÑ Job Description</h3>
          <div style="color: #555; line-height: 1.8; font-size: 15px;">{{ job.description|linebreaks }}</div>
          
          <h3 class="desc-title mt-4" style="color: #333; border-bottom: 3px solid #4c6ef5; padding-bottom: 10px; margin-bottom: 20px; margin-top: 30px; font-weight: 600;">‚úÖ Requirements</h3>
          <div style="color: #555; line-height: 1.8; font-size: 15px;">{{ job.requirements|linebreaks }}</div>
          
          <h3 class="desc-title mt-4" style="color: #333; border-bottom: 3px solid #4c6ef5; padding-bottom: 10px; margin-bottom: 20px; margin-top: 30px; font-weight: 600;">‚ÑπÔ∏è Additional Information</h3>
          <div class="row">
            <div class="col-md-6">
              <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                <div style="font-size: 12px; color: #999; text-transform: uppercase; margin-bottom: 5px;">Job Type</div>
                <div style="font-weight: 600; color: #333;"><i class="lni-briefcase" style="color: #4c6ef5;"></i> {{ job.job_type }}</div>
              </div>
            </div>
            <div class="col-md-6">
              <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                <div style="font-size: 12px; color: #999; text-transform: uppercase; margin-bottom: 5px;">Experience Level</div>
                <div style="font-weight: 600; color: #333;"><i class="lni-rocket" style="color: #4c6ef5;"></i> {{ job.experience_level }}</div>
              </div>
            </div>
            <div class="col-md-6">
              <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                <div style="font-size: 12px; color: #999; text-transform: uppercase; margin-bottom: 5px;">Education</div>
                <div style="font-weight: 600; color: #333;"><i class="lni-graduation" style="color: #4c6ef5;"></i> {{ job.education_level }}</div>
              </div>
            </div>
            <div class="col-md-6">
              <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                <div style="font-size: 12px; color: #999; text-transform: uppercase; margin-bottom: 5px;">Application Deadline</div>
                <div style="font-weight: 600; color: #333;"><i class="lni-calendar" style="color: #4c6ef5;"></i> {{ job.deadline|date:"d M, Y" }}</div>
              </div>
            </div>
          </div>
          {% if job.skills_required %}
          <div style="background: #e7f5ff; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 4px solid #4c6ef5;">
            <div style="font-size: 12px; color: #1864ab; text-transform: uppercase; margin-bottom: 8px; font-weight: 600;">üí° Skills Required</div>
            <div style="color: #1864ab;">{{ job.skills_required }}</div>
          </div>
          {% endif %}
          {% if job.benefits %}
          <div style="background: #d3f9d8; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 4px solid #51cf66;">
            <div style="font-size: 12px; color: #2b8a3e; text-transform: uppercase; margin-bottom: 8px; font-weight: 600;">üéÅ Benefits</div>
            <div style="color: #2b8a3e;">{{ job.benefits }}</div>
          </div>
          {% endif %}
        </div>
        
      </div>
      
      <div class="col-lg-4 col-md-12 col-xs-12">
        <aside class="sidebar">
          <!-- Job Summary Widget -->
          <div class="widget job-summary" style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 20px;">
            <h4 class="widget-title" style="color: #333; border-bottom: 2px solid #4c6ef5; padding-bottom: 12px; margin-bottom: 20px; font-weight: 600;">üìä Job Summary</h4>
            <ul style="list-style: none; padding: 0;">
              <li style="padding: 12px 0; border-bottom: 1px solid #f0f0f0; display: flex; align-items: center;"><i class="lni-user" style="color: #4c6ef5; margin-right: 10px; font-size: 18px;"></i> <span style="color: #999; margin-right: 8px;">Posted By:</span> <span style="font-weight: 600; color: #333;">{{ job.posted_by.username }}</span></li>
              <li style="padding: 12px 0; border-bottom: 1px solid #f0f0f0; display: flex; align-items: center;"><i class="lni-map-marker" style="color: #4c6ef5; margin-right: 10px; font-size: 18px;"></i> <span style="color: #999; margin-right: 8px;">Location:</span> <span style="font-weight: 600; color: #333;">{{ job.location }}</span></li>
              <li style="padding: 12px 0; border-bottom: 1px solid #f0f0f0; display: flex; align-items: center;"><i class="lni-briefcase" style="color: #4c6ef5; margin-right: 10px; font-size: 18px;"></i> <span style="color: #999; margin-right: 8px;">Job Type:</span> <span style="font-weight: 600; color: #333;">{{ job.job_type }}</span></li>
              <li style="padding: 12px 0; border-bottom: 1px solid #f0f0f0; display: flex; align-items: center;"><i class="lni-calendar" style="color: #4c6ef5; margin-right: 10px; font-size: 18px;"></i> <span style="color: #999; margin-right: 8px;">Deadline:</span> <span style="font-weight: 600; color: #333;">{{ job.deadline|date:"d M, Y" }}</span></li>
              <li style="padding: 12px 0; display: flex; align-items: center;"><i class="lni-eye" style="color: #4c6ef5; margin-right: 10px; font-size: 18px;"></i> <span style="color: #999; margin-right: 8px;">Applications:</span> <span style="font-weight: 600; color: #51cf66;">{{ job.applications.count }}</span></li>
            </ul>
          </div>
          
          <!-- Apply Widget -->
          {% if user.is_authenticated %}
            {% if user.role == 'job_seeker' %}
              {% if has_applied %}
              <div class="widget" style="background: #d3f9d8; padding: 20px; border-radius: 8px; border: 2px solid #51cf66; margin-bottom: 20px;">
                <div style="text-align: center; color: #2b8a3e;">
                  <i class="lni-check-mark-circle" style="font-size: 48px; display: block; margin-bottom: 10px;"></i>
                  <strong>Already Applied</strong>
                  <p style="margin: 10px 0 0 0; font-size: 14px;">You have already applied for this job.</p>
                </div>
              </div>
              {% else %}
                <div class="widget" style="margin-bottom: 20px;">
                  <a href="{% url 'jobs:apply_job' job.id %}" class="btn btn-block" style="background: linear-gradient(135deg, #51cf66 0%, #37b24d 100%); color: white; padding: 15px 30px; border: none; border-radius: 8px; font-size: 18px; font-weight: 600; text-decoration: none; display: block; text-align: center; transition: all 0.3s; box-shadow: 0 4px 12px rgba(81, 207, 102, 0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(81, 207, 102, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(81, 207, 102, 0.3)'"><i class="lni-rocket"></i> Apply for This Job</a>
                  <p style="text-align: center; font-size: 12px; color: #666; margin-top: 10px;"><i class="lni-timer"></i> Application deadline: {{ job.deadline|date:"M d, Y" }}</p>
                </div>
              {% endif %}
            {% elif user.role == 'employer' and job.posted_by == user %}
            <div class="widget">
              <a href="{% url 'jobs:edit_job' job.id %}" class="btn btn-common btn-block mb-2">Edit Job</a>
              <a href="{% url 'jobs:job_applications' job.id %}" class="btn btn-common btn-block mb-2">View Applications ({{ job.applications.count }})</a>
              <a href="{% url 'jobs:delete_job' job.id %}" class="btn btn-danger btn-block" onclick="return confirm('Are you sure you want to delete this job?')">Delete Job</a>
            </div>
            {% endif %}
          {% else %}
          <div class="widget">
            <a href="{% url 'accounts:login' %}?next={{ request.path }}" class="btn btn-common btn-block">Login to Apply</a>
          </div>
          {% endif %}
          
          <!-- Company Info Widget -->
          <div class="widget company-info" style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 20px;">
            <h4 class="widget-title" style="color: #333; border-bottom: 2px solid #4c6ef5; padding-bottom: 12px; margin-bottom: 20px; font-weight: 600;">üè¢ Company Information</h4>
            <h5 style="color: #333; margin-bottom: 15px; font-weight: 600;">{{ job.company.company_name }}</h5>
            {% if job.company_description %}
            <p style="color: #666; margin-bottom: 10px; font-size: 14px;">{{ job.company_description }}</p>
            {% endif %}
            {% if job.company_website %}
            <p style="margin: 0;"><i class="lni-world" style="color: #4c6ef5;"></i> <a href="{{ job.company_website }}" target="_blank" style="color: #4c6ef5; text-decoration: none;">Visit Website</a></p>
            {% endif %}
          </div>
          
          <!-- Share Widget -->
          <div class="widget" style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
            <h4 class="widget-title" style="color: #333; border-bottom: 2px solid #4c6ef5; padding-bottom: 12px; margin-bottom: 20px; font-weight: 600;">Share This Job</h4>
            <div class="share-buttons" style="display: flex; flex-direction: column; gap: 10px;">
              <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" target="_blank" class="btn btn-primary" style="width: 100%; padding: 10px;">
                <i class="lni-facebook-filled"></i> Facebook
              </a>
              <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}&text={{ job.title }}" target="_blank" class="btn btn-info" style="width: 100%; padding: 10px;">
                <i class="lni-twitter-filled"></i> Twitter
              </a>
              <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ request.build_absolute_uri }}" target="_blank" class="btn btn-primary" style="width: 100%; padding: 10px;">
                <i class="lni-linkedin-filled"></i> LinkedIn
              </a>
            </div>
          </div>
        </aside>
      </div>
    </div>
  </div>
</section>
<!-- Job Detail Section End -->
{% endblock %}
