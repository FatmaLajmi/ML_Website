{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard - JobML Platform{% endblock %}

{% block content %}
<!-- Page Header Start -->
<div class="page-header">
  <div class="container">
    <div class="row">         
      <div class="col-lg-12">
        <div class="inner-header">
          <h3>Dashboard</h3>
          <p>Welcome back, {{ user.username }}!</p>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Page Header End --> 

<!-- Content section Start --> 
<section id="content" class="section-padding">
  <div class="container">
    {% if user.role == 'job_seeker' %}
    <!-- Job Seeker Dashboard -->
    <div class="row">
      <div class="col-lg-3 col-md-6 col-sm-6 mb-4">
        <div class="box text-center">
          <div class="icon">
            <i class="lni-briefcase"></i>
          </div>
          <h3>{{ applications_count|default:0 }}</h3>
          <p>Applications Submitted</p>
          <a href="{% url 'jobs:jobs_applied' %}" class="btn btn-sm btn-common">View All</a>
        </div>
      </div>
      
      <div class="col-lg-3 col-md-6 col-sm-6 mb-4">
        <div class="box text-center">
          <div class="icon">
            <i class="lni-search"></i>
          </div>
          <h3>{{ available_jobs|default:0 }}</h3>
          <p>Available Jobs</p>
          <a href="{% url 'jobs:job_list' %}" class="btn btn-sm btn-common">Browse Jobs</a>
        </div>
      </div>
      
      <div class="col-lg-3 col-md-6 col-sm-6 mb-4">
        <div class="box text-center">
          <div class="icon">
            <i class="lni-bar-chart"></i>
          </div>
          <h3>ML Tools</h3>
          <p>Prediction Tools</p>
          <a href="{% url 'predictions:job_seeker_predictions' %}" class="btn btn-sm btn-common">Try Now</a>
        </div>
      </div>
      
      <div class="col-lg-3 col-md-6 col-sm-6 mb-4">
        <div class="box text-center">
          <div class="icon">
            <i class="lni-user"></i>
          </div>
          <h3>Profile</h3>
          <p>Manage Your Profile</p>
          <a href="{% url 'accounts:profile' %}" class="btn btn-sm btn-common">Edit Profile</a>
        </div>
      </div>
    </div>
    
    <div class="row mt-4">
      <div class="col-12">
        <h4>Recent Job Recommendations</h4>
        <div class="job-list mt-3">
          {% if recommended_jobs %}
            {% for job in recommended_jobs %}
            <div class="job-box d-md-flex align-items-center justify-content-between mb-3">
              <div class="job-left">
                <h5><a href="{% url 'jobs:job_detail' job.id %}">{{ job.title }}</a></h5>
                <p><i class="lni-map-marker"></i> {{ job.location }} | <i class="lni-briefcase"></i> {{ job.job_type }}</p>
              </div>
              <div class="job-right">
                <a href="{% url 'jobs:job_detail' job.id %}" class="btn btn-common">View Details</a>
              </div>
            </div>
            {% endfor %}
          {% else %}
            <p>No job recommendations available at the moment.</p>
          {% endif %}
        </div>
      </div>
    </div>
    
    {% elif user.role == 'employer' %}
    <!-- Employer Dashboard -->
    <div class="row">
      <div class="col-lg-3 col-md-6 col-sm-6 mb-4">
        <div class="box text-center">
          <div class="icon">
            <i class="lni-briefcase"></i>
          </div>
          <h3>{{ active_jobs|default:0 }}</h3>
          <p>Active Job Postings</p>
          <a href="{% url 'jobs:my_jobs' %}" class="btn btn-sm btn-common">View All</a>
        </div>
      </div>
      
      <div class="col-lg-3 col-md-6 col-sm-6 mb-4">
        <div class="box text-center">
          <div class="icon">
            <i class="lni-users"></i>
          </div>
          <h3>{{ total_applications|default:0 }}</h3>
          <p>Total Applications</p>
          <a href="{% url 'jobs:my_jobs' %}" class="btn btn-sm btn-common">Review</a>
        </div>
      </div>
      
      <div class="col-lg-3 col-md-6 col-sm-6 mb-4">
        <div class="box text-center">
          <div class="icon">
            <i class="lni-bar-chart"></i>
          </div>
          <h3>ML Tools</h3>
          <p>Business Predictions</p>
          <a href="{% url 'predictions:employer_predictions' %}" class="btn btn-sm btn-common">Try Now</a>
        </div>
      </div>
      
      <div class="col-lg-3 col-md-6 col-sm-6 mb-4">
        <div class="box text-center">
          <div class="icon">
            <i class="lni-plus"></i>
          </div>
          <h3>New Job</h3>
          <p>Post a Job</p>
          <a href="{% url 'jobs:post_job' %}" class="btn btn-sm btn-common">Post Now</a>
        </div>
      </div>
    </div>
    
    <div class="row mt-4">
      <div class="col-12">
        <h4>Recent Applications</h4>
        <div class="applications-list mt-3">
          {% if recent_applications %}
            <div class="table-responsive">
              <table class="table table-striped">
                <thead>
                  <tr>
                    <th>Job Title</th>
                    <th>Applicant</th>
                    <th>Applied On</th>
                    <th>Status</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  {% for application in recent_applications %}
                  <tr>
                    <td>{{ application.job.title }}</td>
                    <td>{{ application.applicant.username }}</td>
                    <td>{{ application.applied_at|date:"d M, Y" }}</td>
                    <td><span class="badge badge-info">{{ application.status }}</span></td>
                    <td><a href="{% url 'jobs:job_applications' application.job.id %}" class="btn btn-sm btn-primary">Review</a></td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% else %}
            <p>No recent applications.</p>
          {% endif %}
        </div>
      </div>
    </div>
    {% endif %}
  </div>
</section>
<!-- Content section End -->
{% endblock %}

{% block extra_css %}
<style>
  .box {
    padding: 30px;
    border: 1px solid #e8ecf1;
    border-radius: 8px;
    transition: all 0.3s ease;
  }
  
  .box:hover {
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
  }
  
  .box .icon {
    font-size: 48px;
    color: #4c40ed;
    margin-bottom: 15px;
  }
  
  .box h3 {
    margin-bottom: 10px;
  }
  
  .job-box {
    padding: 20px;
    border: 1px solid #e8ecf1;
    border-radius: 8px;
  }
</style>
{% endblock %}
