{% extends 'base.html' %}
{% load static %}

{% block title %}Company Growth Prediction - Employers - JobML Platform{% endblock %}

{% block content %}
<!-- Page Header Start -->
<div class="page-header">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="inner-header">
          <h3>Company Revenue Growth Prediction</h3>
          <p>Forecast your company's revenue growth percentage</p>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Page Header End -->

<!-- Content Section Start -->
<section id="content" class="section-padding">
  <div class="container">
    
    <!-- Messages -->
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
      {% endfor %}
    {% endif %}
    
    <div class="row justify-content-center">
      <div class="col-lg-8">
        
        <!-- Prediction Result -->
        {% if result %}
        <div class="card mb-4">
          <div class="card-header bg-{% if result.growth_percentage >= 15 %}success{% elif result.growth_percentage >= 0 %}warning{% else %}danger{% endif %} text-white">
            <h4 class="mb-0">
              <i class="lni-{% if result.growth_percentage >= 15 %}rocket{% elif result.growth_percentage >= 0 %}thumbs-up{% else %}warning{% endif %}"></i>
              Prediction Result
            </h4>
          </div>
          <div class="card-body">
            <div class="result-box text-center py-4">
              <h2 class="mb-3">{{ result.growth_percentage_formatted }}</h2>
              <p class="lead mb-2">
                <strong>Growth Category:</strong> {{ result.interpretation }}
              </p>
              <hr>
              <p class="text-muted">
                {% if result.growth_percentage >= 15 %}
                  <i class="lni-rocket"></i>
                  Excellent! Your company is projected to experience significant revenue growth.
                  This indicates strong market position and expansion potential.
                {% elif result.growth_percentage >= 0 %}
                  <i class="lni-thumbs-up"></i>
                  Your company is expected to grow at a healthy, sustainable rate.
                  Continue your current strategies while exploring new opportunities.
                {% else %}
                  <i class="lni-warning"></i>
                  Warning: Negative growth predicted. Review your business model
                  and explore new revenue streams to reverse this trend.
                {% endif %}
              </p>
            </div>
          </div>
        </div>
        {% endif %}
        
        <!-- Prediction Form -->
        <div class="card">
          <div class="card-header bg-primary text-white">
            <h4 class="mb-0">
              <i class="lni-search"></i>
              Enter Company Data
            </h4>
          </div>
          <div class="card-body">
            <form method="post" action="{% url 'predictions:employer_growth' %}">
              {% csrf_token %}
              
              <!-- Current Workers (Required) -->
              <div class="form-group">
                <label for="id_workers">
                  Current Number of Employees <span class="text-danger">*</span>
                </label>
                <input 
                  type="number" 
                  name="workers" 
                  id="id_workers"
                  class="form-control" 
                  placeholder="e.g., 150"
                  min="0"
                  required
                  value="{{ form_data.workers|default:'' }}"
                >
                <small class="form-text text-muted">
                  Total number of current employees
                </small>
              </div>
              
              <!-- Current Revenue -->
              <div class="form-group">
                <label for="id_revenue">
                  Current Annual Revenue ($) <span class="text-danger">*</span>
                </label>
                <input 
                  type="number" 
                  name="revenue" 
                  id="id_revenue"
                  class="form-control" 
                  placeholder="e.g., 5000000"
                  min="0"
                  step="0.01"
                  required
                  value="{{ form_data.revenue|default:'' }}"
                >
                <small class="form-text text-muted">
                  Current annual revenue in dollars
                </small>
              </div>
              
              <!-- Previous Workers (Required) -->
              <div class="form-group">
                <label for="id_previous_workers">
                  Previous Number of Employees <span class="text-danger">*</span>
                </label>
                <input 
                  type="number" 
                  name="previous_workers" 
                  id="id_previous_workers"
                  class="form-control" 
                  placeholder="e.g., 120"
                  min="0"
                  required
                  value="{{ form_data.previous_workers|default:'' }}"
                >
                <small class="form-text text-muted">
                  Number of employees in the previous period
                </small>
              </div>
              
              <!-- Optional Fields -->
              <h5 class="mt-4 mb-3">Optional Information</h5>
              
              <!-- Delta Workers -->
              <div class="form-group">
                <label for="id_delta_workers">Change in Employees</label>
                <input 
                  type="number" 
                  name="delta_workers" 
                  id="id_delta_workers"
                  class="form-control" 
                  placeholder="e.g., 30"
                  value="{{ form_data.delta_workers|default:'' }}"
                >
                <small class="form-text text-muted">
                  Net change in employees (can be negative)
                </small>
              </div>
              
              <!-- Founded Year -->
              <div class="form-group">
                <label for="id_founded">Year Founded</label>
                <input 
                  type="number" 
                  name="founded" 
                  id="id_founded"
                  class="form-control" 
                  placeholder="e.g., 2010"
                  min="1800"
                  max="2026"
                  value="{{ form_data.founded|default:'' }}"
                >
                <small class="form-text text-muted">
                  Year the company was founded
                </small>
              </div>
              
              <!-- Industry (Optional) -->
              <div class="form-group">
                <label for="id_industry">Industry (Optional)</label>
                <input 
                  type="text" 
                  name="industry" 
                  id="id_industry"
                  class="form-control" 
                  placeholder="e.g., Technology, Healthcare, Finance"
                  value="{{ form_data.industry|default:'' }}"
                >
                <small class="form-text text-muted">
                  Your company's primary industry
                </small>
              </div>
              
              <!-- Submit Button -->
              <div class="form-group text-center mt-4">
                <button type="submit" class="btn btn-common btn-lg">
                  <i class="lni-rocket"></i> Predict Company Growth
                </button>
              </div>
            </form>
          </div>
        </div>
        
        <!-- Info Box -->
        <div class="alert alert-info mt-4">
          <h5><i class="lni-information"></i> How it works</h5>
          <p class="mb-0">
            Our LightGBM machine learning model analyzes your company's employee count, revenue,
            and historical growth patterns to predict future revenue growth percentage. The model
            uses advanced feature engineering including logarithmic transformations and growth
            rates to provide accurate forecasts.
          </p>
        </div>
        
      </div>
    </div>
  </div>
</section>
<!-- Content Section End -->
{% endblock %}

{% block extra_css %}
<style>
  .card {
    border: none;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    border-radius: 8px;
  }
  
  .card-header {
    border-radius: 8px 8px 0 0 !important;
    padding: 1.25rem;
  }
  
  .result-box {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 2rem;
  }
  
  .result-box h2 {
    font-weight: 700;
    color: #333;
  }
  
  .form-group label {
    font-weight: 600;
    color: #555;
    margin-bottom: 0.5rem;
  }
  
  .form-control {
    border-radius: 5px;
    border: 1px solid #ddd;
    padding: 0.75rem;
  }
  
  .form-control:focus {
    border-color: #4c40ed;
    box-shadow: 0 0 0 0.2rem rgba(76, 64, 237, 0.25);
  }
  
  .btn-common {
    padding: 0.75rem 2rem;
    font-weight: 600;
    border-radius: 5px;
  }
  
  .page-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 80px 0 60px;
  }
  
  .page-header h3 {
    color: white;
    font-size: 2.5rem;
    font-weight: 700;
  }
  
  .page-header p {
    color: rgba(255,255,255,0.9);
    font-size: 1.1rem;
  }
</style>
{% endblock %}
